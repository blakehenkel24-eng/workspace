## 2026-02-10 - Security Audit & Hardening

Saki ran a comprehensive security audit of OpenClaw container/VPS. Critical and high-risk issues were identified and fixed.

### Critical Issues Fixed
1. **Disabled insecure auth** (`allowInsecureAuth: false`)
2. **Regenerated all tokens** - gateway auth, gateway remote, exec-approval socket (now all unique)
3. **Moved API keys to secure storage** - `.secrets.env` (chmod 600) instead of plaintext in config
4. **Added cron safeguards** - autonomous jobs now stage changes but don't auto-push to main
5. **Tightened file permissions** - all sensitive files now 600, directories 700

### Remaining Actions for Blake
1. **Regenerate ALL API keys immediately** - they were exposed during the audit
   - Kimi, OpenAI, OpenRouter, Anthropic, Brave, Telegram
2. **Restart OpenClaw container** to apply new tokens
3. **Fix /etc/shadow permissions** in Dockerfile
4. **Set up `.secrets.env` loading** in container startup script

### Files Changed
- `/home/node/.openclaw/openclaw.json`
- `/home/node/.openclaw/exec-approvals.json`
- `/home/node/.openclaw/cron/jobs.json`
- `/home/node/.openclaw/.secrets.env` (new secure secrets file)
- `/home/node/.openclaw/SECURITY_AUDIT_2026-02-10.md` (full report)

### Key Security Wins
- Secrets now isolated in 600-permission file
- No more auto-push to main from cron jobs
- Tokens rotated and diversified
- Auth now requires proper security
- All sensitive configs locked down

**Risk Profile:** Reduced from HIGH to MEDIUM (pending API key rotation)
